### 基本原理
>**CRC 校验**的基本原理是
>将需要传输的二进制数据看作一个多项式的系数，通过选定一个特定的生成多项式，用该多项式对数据多项式进行模 2 除法运算，得到的余数就是 CRC 校验码。
>在数据传输时，将原始数据和 CRC 校验码一起发送。接收方在收到数据后，使用相同的生成多项式对接收到的数据（包括校验码）进行同样的模 2 除法运算，如果得到的余数为零，则认为数据在传输过程中没有发生错误；否则，说明数据可能出现了错误。

### 参数模型
一个完整的CRC参数模型应该包含以下信息：WIDTH，POLY，INIT，REFIN，REFOUT，XOROUT。

- NAME：参数模型名称。
- WIDTH：宽度，即生成的CRC数据位宽，如CRC-8，生成的CRC为8位
- POLY：十六进制多项式，省略最高位1，如 x8 + x2 + x + 1，二进制为1 0000 0111，省略最高位1，转换为十六进制为0x07。
- INIT：CRC初始值，和WIDTH位宽一致。
- REFIN：true或false，在进行计算之前，原始数据是否翻转，如原始数据：0x34 = 0011 0100，如果REFIN为true，进行翻转之后为0010 1100 = 0x2c
- REFOUT：true或false，运算完成之后，得到的CRC值是否进行翻转，如计算得到的CRC值：0x97 = 1001 0111，如果REFOUT为true，进行翻转之后为11101001 = 0xE9。  
- XOROUT：计算结果与此参数进行异或运算后得到最终的CRC值，和WIDTH位宽一致。

**常用的21个标准CRC参数模型:**
![[CRC校验表.jpg]]

### CRC计算实例

**问：原始数据：0x34，使用CRC-8/MAXIN参数模型，求CRC值？**

答：根据CRC参数模型表，得到CRC-8/MAXIN的参数如下：

```c
POLY = 0x31 = 0011 0001(最高位1已经省略)
INIT = 0x00
XOROUT = 0x00
REFIN = TRUE
REFOUT = TRUE
```

有了上面的参数，这样计算条件才算完整，下面来实际计算：

```text
0.原始数据 = 0x34 = 0011 0100，多项式 = 0x31 = 1 0011 0001
1.INIT = 00，原始数据高8位和初始值进行异或运算保持不变。
2.REFIN为TRUE，需要先对原始数据进行翻转：0011 0100 > 0010 1100
3.原始数据左移8位，即后面补8个0：0010 1100 0000 0000
4.把处理之后的数据和多项式进行模2除法，求得余数：
原始数据：0010 1100 0000 0000 = 10 1100 0000 0000
多项式：1 0011 0001
模2除法取余数低8位：1111 1011
5.与XOROUT进行异或，1111 1011 xor 0000 0000 = 1111 1011 
6.因为REFOUT为TRUE，对结果进行翻转得到最终的CRC-8值：1101 1111 = 0xDF
7.数据+CRC：0011 0100 1101 1111 = 34DF，相当于原始数据左移8位+余数。
```